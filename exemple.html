<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="author" lang="fr" content="Thao LE" />

  <link type="image/png" rel="icon" href="assomasi.png" />
  <link type="image/png" rel="shortcut icon" href="assomasi.png" />

  <link rel="stylesheet" type="text/css" href="assomasi-cours_2020.css" title="assomasi-lppme-css" />
  <link rel="stylesheet" type="text/css" href="assomasi-cours_2020_print.css" media="print" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />


  <script type="text/javascript" src="index.js"></script>


</head>

<body>



<div id="Div_FichierHTML">

  <h2>Quelques fonctions JavaScript Canvas pour le projet</h2>

  <h4>Entrée de données dans un textarea</h4>

  <form style="margin-left:0px">
<textarea rows="11" cols="40" id="text-input">
T2 &lt; T3
T4 &lt; T1
T1 &lt; T3
T4 &lt; T5
T5 &lt; T2
T1
T2
T3
T1 &lt; T2
T3 &lt; T8
</textarea>
    <p>
      <input type="button" value="Lecture d'un fichier"
             onclick='Lecture_Fichier()' id="id-LF " />
      <input type="button" value="Traitement (ici juste un tri)"
             onclick='Traitement()' id="id-t" />
  </form>
  </p>



  <h3>Résultats</h3>

  <form style="margin-left:0px">
<textarea rows="12" cols="40" id="text-output" readonly="readonly">
</textarea>
  </form>


  <canvas style="background: #eee;" id="myCanvasA" width="800" height="400"></canvas>

  <script>
    var canvasA = document.getElementById( "myCanvasA" );
    var ctxA = canvasA.getContext( "2d" );


    function PoseTache( ctx, p_NX, p_NY, p_Nom, p_Color ) {
      BD = 40;
      DX = 80;
      DY = 80;
      PosX = BD + (p_NX -1) * DX;
      PosY = BD + (p_NY -1) * DY;
      console.log( p_NX, PosX, p_NY, PosY );

      Dessiner_TACHE( ctx, PosX, PosY, p_Nom, p_Color );
    } // >>>> PoseTache


    PoseTache( ctxA, 1, 1, "T1", "blue" );
    PoseTache( ctxA, 2, 2, "T2", "blue" );
  </script>


  <h3>Script utilisé et inclus dans cette page</h3>

  <!--@programme@./JavaScript/Lecture_textarea.js-->

  <h3>Remarques</h3>

  <p>
    Dans la zone du <b>textarea</b> <span style="color:#dd00dd">dans la page HTML</span>,
    les  « <b>&lt;</b> » sont codés <b>&amp;lt;</b>
  </p>

  <p class="p-plus">
    Un script mis dans une page HTML doit être en principe mis en
    commentaires c'est à dire entre les séquences  <b>&lt;!--</b> et <b>--&gt;</b>
  </p>

  <p class="p-plus">
    Ici avec ce tri simple une tâche <b>T11</b> va se retrouver entre <b>T1</b> et <b>T2</b>
  </p>
  <p class="p-plus">
    Pour pallier cet inconvénient ... on peut se limiter à 9 tâches
    .. appeler les tâches <b>T01</b>, <b>T02</b> ...
  </p>


  <h3>Quelques fonctions à s'approprier et à reformuler..</h3>

  <!--@programme@JavaScript/Fonctions-Canvas_Projet.js-->

  <script>


    function Traitement() {

      text_input = document.getElementById( "text-input" ).value; // Lit le texte

      text_input = text_input.replace( /&lt;/g, "<" ); // Remplace le codage dans le textarea

      const strCopy = text_input.split( "\n"); // Crée un tableau

      strCopy.sort(); // Trie le tableau

      first = strCopy[ 0 ].trim(); // Enlève les éléments vides

      while ( ( strCopy.length > 0 ) && ( first == "" ) ) {
        strCopy.shift(); // supprime le 1er element
        first = strCopy[ 0 ].trim();
      }

      for ( let KL = 0; KL < strCopy.length; KL++ ) {
        strCopy[ KL ] = strCopy[ KL ].trim();
      }

      strCopy.sort(); // trie les lignes trimmées

      TabRes = new Array();

      for ( let KL = 0; KL < strCopy.length; KL++ ) {

        Ligne =  strCopy[ KL ];

        let TabT = Ligne.split( "<" );

        for ( KT = 0; KT < TabT.length; KT++ ) {
          console.log( KL + ": " + KT + " : " + TabT[ KT ].trim() );
          TabRes.push( TabT[ KT ].trim() );
        }
      }

      uniqueAndSorted = [...new Set( TabRes )].sort();
      //  https://stackoverflow.com/questions/4833651/javascript-array-sort-and-unique/42495707

      console.log( uniqueAndSorted );

      text_output = uniqueAndSorted.join( "\n" ); // Crée un texte

      document.getElementById( "text-output" ).innerHTML = text_output; //  Écrit le texte obtenu
    }

  </script>


  <br/>
  <br/>
</div>  <!--Div_FichierHTML -->

</body>
</html>